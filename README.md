# Karatag - ربات إدارة مجموعات تيليجرام

## 📋 وصف المشروع

**Karatag** هو ربات تيليجرام متقدم لإدارة المجموعات والمحتوى النصي والوسائط. يتميز هذا الربات بقدرات متنوعة تشمل وسم الأعضاء وإرسال المحتوى وإدارة المجموعات ونظام الدعم.

## ✨ الميزات الرئيسية

- 🔖 **إدارة المجموعات**: تسجيل وحذف وإدارة مجموعات تيليجرام
- 📝 **إدارة المحتوى**: حفظ وإرسال النصوص والوسائط
- 👥 **وسم الأعضاء**: وسم أعضاء المجموعة بالنص أو الوسائط
- 🛡️ **نظام الأمان**: الحماية من الرسائل المزعجة والمستخدمين غير المصرح لهم
- 📊 **الإحصائيات والتقارير**: عرض إحصائيات دقيقة للمجموعات والمستخدمين
- 🎯 **نظام الدعم**: إدارة طلبات الدعم
- 🔄 **نظام الموافقة**: مراجعة والموافقة على المحتوى المرسل من المستخدمين

## 🚀 التثبيت والإعداد

### المتطلبات الأساسية

- Python 3.7 أو أحدث
- حساب تيليجرام مع بيانات اعتماد API
- الوصول إلى مجموعات تيليجرام

### خطوات التثبيت

1. **استنساخ المشروع**
```bash
git clone https://github.com/mrVXBoT/karatag-v2.git
cd karatag-v2
```

2. **تثبيت التبعيات**
```bash
pip install -r requirements.txt
```

3. **إعداد ملف config.py**
```python
# في ملف config.py أدخل المعلومات التالية:
api_id = 'YOUR_API_ID'
api_hash = 'YOUR_API_HASH'
token = 'YOUR_BOT_TOKEN'
sudo = [ADMIN_USER_ID_1, ADMIN_USER_ID_2]  # معرفات المشرفين
```

4. **تشغيل الربات**
```bash
python main.py
```

## 📁 هيكل المشروع

```
karatag-v2/
├── main.py                 # الملف الرئيسي ومشغل الربات
├── config.py              # الإعدادات والتكوين
├── requirements.txt        # تبعيات بايثون
├── data.db                # قاعدة بيانات SQLite
├── kara.session           # ملف جلسة تيليجرام
├── lib/                   # المكتبات الداخلية
│   ├── db.py             # نماذج قاعدة البيانات
│   ├── decorators.py     # مزينات الأمان
│   └── Paginator.py      # نظام الترقيم
├── plugs/                 # الإضافات والأوامر
│   └── m.py              # الإضافة الرئيسية
└── tools/                 # الأدوات المساعدة
    ├── check_groups.py    # فحص المجموعات
    └── check_groups_info.py # معلومات المجموعات
```

## 🗄️ قاعدة البيانات

يستخدم المشروع SQLite ويتضمن الجداول التالية:

- **User**: معلومات المستخدمين وحالتهم
- **Group**: معلومات المجموعات والإعدادات
- **Media**: ملفات الوسائط والتعليقات
- **Text**: النصوص المحفوظة
- **Setting**: إعدادات النظام
- **Support**: طلبات الدعم
- **PendingSubmission**: المحتوى في انتظار الموافقة

## 🎮 الأوامر الرئيسية

### الأوامر العامة
- `/start` - بدء الربات
- `/help` - دليل الأوامر

### أوامر المشرف
- `/addgroup` - إضافة مجموعة جديدة
- `/delgroup` - حذف مجموعة
- `/stats` - عرض الإحصائيات
- `/broadcast` - إرسال رسالة لجميع المجموعات

### أوامر إدارة المحتوى
- `/addtext` - إضافة نص جديد
- `/addmedia` - إضافة وسائط جديدة
- `/tagall` - وسم جميع الأعضاء
- `/tagtext` - وسم بالنص
- `/tagmedia` - وسم بالوسائط

## ⚙️ الإعدادات

### إعدادات الأمان
- `delay`: التأخير بين العمليات (120 ثانية)
- `delay1`: التأخير القصير (20 ثانية)
- نظام الحماية من الرسائل المزعجة
- فحص صلاحيات المشرف

### إعدادات القنوات
- `log_channel`: قناة التقارير
- `files_channel`: قناة حفظ الملفات
- `join_channel`: قناة الانضمام

## 🔧 التطوير والتخصيص

### إضافة إضافة جديدة
1. أنشئ ملف جديد في مجلد `plugs/`
2. استخدم المزينات الموجودة
3. سجل الإضافة في `main.py`

### تغييرات قاعدة البيانات
- استخدم `playhouse.migrate` للتغييرات
- عرّف النماذج الجديدة في `lib/db.py`

## 📊 المراقبة والصيانة

### فحص صحة النظام
```bash
python check_groups.py          # فحص حالة المجموعات
python check_groups_info.py     # معلومات مفصلة عن المجموعات
python simple_group_checker.py  # فحص بسيط للمجموعات
```

### التنظيف التلقائي
- حذف المجموعات غير الصالحة
- حذف المستخدمين غير النشطين
- تحسين قاعدة البيانات

## 🚨 استكشاف الأخطاء

### المشاكل الشائعة
1. **خطأ API**: تحقق من صحة `api_id` و `api_hash`
2. **خطأ الوصول**: تحقق من صلاحيات الربات في المجموعات
3. **خطأ قاعدة البيانات**: تحقق من ملف `data.db`

### السجلات
- تعرض السجلات في وحدة التحكم
- لمعرفة المزيد فعّل `logging.DEBUG`

## 📝 ملاحظات مهمة

- صمم هذا الربات للاستخدام في مجموعات تيليجرام
- تأكد من منح الصلاحيات اللازمة للربات
- تجنب إرسال الرسائل المتكررة
- صمم نظام الموافقة على المحتوى لمنع سوء الاستخدام

## 🤝 المساهمة

أنشأ هذا المشروع وصيانته فريق مطوري Karatag. للإبلاغ عن المشاكل أو الاقتراحات، يرجى الاتصال بفريق التطوير.

## 📄 الترخيص

يُنشر هذا المشروع تحت ترخيص [اسم الترخيص].

---

**تنبيه**: صمم هذا الربات للاستخدام القانوني والأخلاقي. يرجى استخدامه ضمن إطار قوانين تيليجرام والمبادئ الأخلاقية.

---

# Karatag - ربات مدیریت گروه تلگرام

## 📋 توضیحات پروژه

**Karatag** یک ربات تلگرام پیشرفته برای مدیریت گروه‌ها، محتوای متنی و رسانه‌ای است. این ربات قابلیت‌های متنوعی از جمله تگ کردن اعضا، ارسال محتوا، مدیریت گروه‌ها و سیستم پشتیبانی دارد.

## ✨ ویژگی‌های اصلی

- 🔖 **مدیریت گروه‌ها**: ثبت، حذف و مدیریت گروه‌های تلگرام
- 📝 **مدیریت محتوا**: ذخیره و ارسال متن‌ها و رسانه‌ها
- 👥 **تگ کردن اعضا**: تگ کردن اعضای گروه با متن یا رسانه
- 🛡️ **سیستم امنیتی**: محافظت در برابر اسپم و کاربران غیرمجاز
- 📊 **آمار و گزارش**: نمایش آمار دقیق گروه‌ها و کاربران
- 🎯 **سیستم پشتیبانی**: مدیریت درخواست‌های پشتیبانی
- 🔄 **سیستم تایید**: بررسی و تایید محتوای ارسالی کاربران

## 🚀 نصب و راه‌اندازی

### پیش‌نیازها

- Python 3.7 یا بالاتر
- حساب تلگرام با API credentials
- دسترسی به گروه‌های تلگرام

### مراحل نصب

1. **کلون کردن پروژه**
```bash
git clone https://github.com/mrVXBoT/karatag-v2.git
cd karatag-v2
```

2. **نصب وابستگی‌ها**
```bash
pip install -r requirements.txt
```

3. **تنظیم فایل config.py**
```python
# در فایل config.py اطلاعات زیر را وارد کنید:
api_id = 'YOUR_API_ID'
api_hash = 'YOUR_API_HASH'
token = 'YOUR_BOT_TOKEN'
sudo = [ADMIN_USER_ID_1, ADMIN_USER_ID_2]  # شناسه‌های ادمین‌ها
```

4. **اجرای ربات**
```bash
python main.py
```

## 📁 ساختار پروژه

```
karatag-v2/
├── main.py                 # فایل اصلی و راه‌انداز ربات
├── config.py              # تنظیمات و پیکربندی
├── requirements.txt        # وابستگی‌های پایتون
├── data.db                # پایگاه داده SQLite
├── kara.session           # فایل نشست تلگرام
├── lib/                   # کتابخانه‌های داخلی
│   ├── db.py             # مدل‌های پایگاه داده
│   ├── decorators.py     # دکوراتورهای امنیتی
│   └── Paginator.py      # سیستم صفحه‌بندی
├── plugs/                 # پلاگین‌ها و دستورات
│   └── m.py              # پلاگین اصلی
└── tools/                 # ابزارهای کمکی
    ├── check_groups.py    # بررسی گروه‌ها
    └── check_groups_info.py # اطلاعات گروه‌ها
```

## 🗄️ پایگاه داده

پروژه از SQLite استفاده می‌کند و شامل جداول زیر است:

- **User**: اطلاعات کاربران و وضعیت آنها
- **Group**: اطلاعات گروه‌ها و تنظیمات
- **Media**: فایل‌های رسانه‌ای و کپشن‌ها
- **Text**: متن‌های ذخیره شده
- **Setting**: تنظیمات سیستم
- **Support**: درخواست‌های پشتیبانی
- **PendingSubmission**: محتوای در انتظار تایید

## 🎮 دستورات اصلی

### دستورات عمومی
- `/start` - شروع ربات
- `/help` - راهنمای دستورات

### دستورات ادمین
- `/addgroup` - افزودن گروه جدید
- `/delgroup` - حذف گروه
- `/stats` - نمایش آمار
- `/broadcast` - ارسال پیام به همه گروه‌ها

### دستورات مدیریت محتوا
- `/addtext` - افزودن متن جدید
- `/addmedia` - افزودن رسانه جدید
- `/tagall` - تگ کردن همه اعضا
- `/tagtext` - تگ کردن با متن
- `/tagmedia` - تگ کردن با رسانه

## ⚙️ تنظیمات

### تنظیمات امنیتی
- `delay`: تاخیر بین عملیات (120 ثانیه)
- `delay1`: تاخیر کوتاه (20 ثانیه)
- سیستم محافظت در برابر اسپم
- بررسی دسترسی‌های ادمین

### تنظیمات کانال‌ها
- `log_channel`: کانال گزارش‌گیری
- `files_channel`: کانال ذخیره فایل‌ها
- `join_channel`: کانال عضویت

## 🔧 توسعه و سفارشی‌سازی

### افزودن پلاگین جدید
1. فایل جدید در پوشه `plugs/` ایجاد کنید
2. از دکوراتورهای موجود استفاده کنید
3. در `main.py` پلاگین را ثبت کنید

### تغییرات پایگاه داده
- از `playhouse.migrate` برای تغییرات استفاده کنید
- مدل‌های جدید را در `lib/db.py` تعریف کنید

## 📊 مانیتورینگ و نگهداری

### بررسی سلامت سیستم
```bash
python check_groups.py          # بررسی وضعیت گروه‌ها
python check_groups_info.py     # اطلاعات تفصیلی گروه‌ها
python simple_group_checker.py  # بررسی ساده گروه‌ها
```

### پاکسازی خودکار
- حذف گروه‌های نامعتبر
- حذف کاربران غیرفعال
- بهینه‌سازی پایگاه داده

## 🚨 عیب‌یابی

### مشکلات رایج
1. **خطای API**: بررسی صحت `api_id` و `api_hash`
2. **خطای دسترسی**: بررسی دسترسی‌های ربات در گروه‌ها
3. **خطای پایگاه داده**: بررسی فایل `data.db`

### لاگ‌ها
- لاگ‌ها در کنسول نمایش داده می‌شوند
- برای اطلاعات بیشتر `logging.DEBUG` را فعال کنید

## 📝 یادداشت‌های مهم

- این ربات برای استفاده در گروه‌های تلگرام طراحی شده است
- حتماً دسترسی‌های لازم را به ربات بدهید
- از ارسال پیام‌های مکرر خودداری کنید
- سیستم تایید محتوا برای جلوگیری از سوء استفاده طراحی شده است

## 🤝 مشارکت

این پروژه توسط تیم توسعه‌دهندگان Karatag ایجاد و نگهداری می‌شود. برای گزارش مشکلات یا پیشنهادات، لطفاً با تیم توسعه تماس بگیرید.

## 📄 مجوز

این پروژه تحت مجوز [نام مجوز] منتشر شده است.

---

**توجه**: این ربات برای استفاده قانونی و اخلاقی طراحی شده است. لطفاً از آن در چارچوب قوانین تلگرام و اصول اخلاقی استفاده کنید.

---

## 🔗 لینک‌های مفید

- **مخزن اصلی**: [https://github.com/mrVXBoT/karatag-v2.git](https://github.com/mrVXBoT/karatag-v2.git)
- **نسخه فعلی**: v2.0
- **آخرین به‌روزرسانی**: فقط به‌روزرسانی

## 📚 آموزش نصب کامل

### مرحله 1: آماده‌سازی محیط

```bash
# نصب Python (اگر نصب نیست)
# Windows: دانلود از python.org
# Linux/Mac: sudo apt install python3

# بررسی نسخه Python
python --version
# یا
python3 --version
```

### مرحله 2: دانلود پروژه

```bash
# کلون کردن مخزن
git clone https://github.com/mrVXBoT/karatag-v2.git

# ورود به پوشه پروژه
cd karatag-v2

# بررسی فایل‌ها
ls
# یا در Windows
dir
```

### مرحله 3: نصب وابستگی‌ها

```bash
# نصب pip (اگر نصب نیست)
# Windows: python -m ensurepip --upgrade
# Linux/Mac: sudo apt install python3-pip

# نصب وابستگی‌ها
pip install -r requirements.txt

# یا در صورت نیاز
pip3 install -r requirements.txt
```

### مرحله 4: تنظیم Telegram Bot

1. **ایجاد ربات در Telegram**:
   - پیام به [@BotFather](https://t.me/BotFather)
   - دستور `/newbot`
   - انتخاب نام و username
   - دریافت `BOT_TOKEN`

2. **دریافت API Credentials**:
   - مراجعه به [my.telegram.org](https://my.telegram.org)
   - ورود با شماره موبایل
   - ایجاد اپلیکیشن جدید
   - دریافت `API_ID` و `API_HASH`

### مرحله 5: تنظیم فایل config.py

```python
# ویرایش فایل config.py
api_id = 12345678  # API ID شما
api_hash = 'abcdef1234567890abcdef1234567890'  # API Hash شما
token = '1234567890:ABCdefGHIjklMNOpqrsTUVwxyz'  # توکن ربات شما

# شناسه‌های ادمین‌ها (User ID)
sudo = [123456789, 987654321]

# تنظیمات کانال‌ها
log_channel = 'your_log_channel'
join_channel = 'your_join_channel'
files_channel = 'your_files_channel'

# تنظیمات تاخیر
delay = 120  # تاخیر بین عملیات (ثانیه)
delay1 = 20  # تاخیر کوتاه (ثانیه)
```

### مرحله 6: اجرای ربات

```bash
# اجرای ربات
python main.py

# یا
python3 main.py
```

### مرحله 7: تست عملکرد

1. **ارسال دستور `/start`** به ربات
2. **بررسی لاگ‌ها** در کنسول
3. **تست دستورات ادمین** در گروه

## 🚨 رفع مشکلات رایج

### مشکل: خطای "Module not found"
```bash
# نصب مجدد وابستگی‌ها
pip install --upgrade -r requirements.txt
```

### مشکل: خطای "Invalid API credentials"
- بررسی صحت `api_id` و `api_hash`
- اطمینان از فعال بودن اپلیکیشن در my.telegram.org

### مشکل: خطای "Bot token invalid"
- بررسی صحت توکن ربات
- اطمینان از فعال بودن ربات در @BotFather

### مشکل: خطای "Permission denied"
- بررسی دسترسی‌های ربات در گروه
- اطمینان از ادمین بودن ربات

## 📱 دستورات مفید برای مدیریت

```bash
# بررسی وضعیت گروه‌ها
python check_groups.py

# اطلاعات تفصیلی گروه‌ها
python check_groups_info.py

# بررسی ساده گروه‌ها
python simple_group_checker.py

# پاکسازی پایگاه داده
rm data.db
python main.py  # ایجاد مجدد پایگاه داده
```

## 🔒 نکات امنیتی

1. **هرگز فایل config.py را در گیت‌هاب آپلود نکنید**
2. **از توکن‌های قوی استفاده کنید**
3. **دسترسی‌های ربات را محدود کنید**
4. **لاگ‌ها را به‌طور منظم بررسی کنید**

## 📞 پشتیبانی

برای دریافت کمک و پشتیبانی:
- ایجاد Issue در [GitHub Repository](https://github.com/mrVXBoT/karatag-v2.git)
- تماس با تیم توسعه Karatag
- بررسی مستندات و راهنماها
